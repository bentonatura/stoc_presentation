<!DOCTYPE html>
<html lang="en">
<head>
  <title>Linear Programming Slides</title>
  <script src="lib/js/jquery-1.11.2.min.js"></script>
  <script src="lib/js/jcanvas.min.js"></script>
  <script src="lib/js/queue.min.js"></script>
  <script src="js/geometry.js"></script>
  <script src="js/graph.js"></script>
  <script src="js/triangulate.js"></script>
  <script src="js/sim.js"></script>
  <script src="js/index.js"></script>
  <script src="data/banana.js"></script>
  <script src="data/key.js"></script>
  <script src="data/ty.js"></script>
  <script src="data/sheet.js"></script>
  <script src="data/guitar.js"></script>
  <script src="js/steps.js"></script>
  <script src="Chart.min.js"></script>
  <script src="Chart.js/samples/utils.js"></script>

<link rel="stylesheet" href="KaTeX/dist/katex.min.css">
<script defer src="KaTeX/dist/katex.min.js"></script>
<script defer src="KaTeX/dist/contrib/auto-render.min.js"
   ></script>
   <script>
    document.addEventListener("DOMContentLoaded", function() {
        console.log("Run Katex rendering")
        renderMathInElement(document.body, {
              delimiters: [
                  {left: "$$$", right: "$$$", display: true},
                  {left: "$$", right: "$$", display: false},
              ]
        });
    });
</script>


  <!-- <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
  "HTML-CSS" : {
        availableFonts : ["STIX"],
        preferredFont : "STIX",
        webFont : "STIX-Web",
        imageFont : null
    },
  tex2jax: {
    inlineMath: [ ['$','$'], ['\\(','\\)'] ]
  },
  TeX: {
    Macros: {
      energy: "e",
      eqby: ["\\stackrel{#1}{=}",1],
    }
  }
  });
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
 -->

  <link rel="stylesheet" type="text/css" href="css/index.css" />
  <link rel="stylesheet" type="text/css" href="css/steps.css" />
  <link rel="stylesheet" type="text/css" href="css/aussois-styles.css" />
  <link rel="stylesheet" type="text/css" href="css/joris_styles.css" />
<!-- <script src="/Users/natura/Downloads/less.js/dist/less.js" ></script> -->

</head>
<body>
<div id="impress" data-perspective="0" data-min-scale="1" data-max-scale="1" data- data-transition-duration="0">

    <div id="step-title-joris" class="step title-joris" data-x="4000" data-y="5000" data-z="0" data-scale="1">
        <div class="talk_title_container">
            <div class="talk_title">
              <div style="font-size:130%;margin-bottom:0.2em; margin-top:.4em;">A scaling-invariant algorithm for linear programming</div>
            </div>
            <div class="talk_subtitle">
              <div style="font-size:130%;margin-bottom:0.2em;">whose running time only depends on the constraint matrix</div>
            </div>
          </div>
          <div class="talk_author_container" style="margin-bottom: 0.1em;">
             <div class="talk_author_name"> Bento Natura <span class="superscript">&nbsp;</span></div>
            <div class="talk_author_affiliation"> London School of Economics and Political Science </div>
          </div>
            <div class="talk_author_container">
               <div class="talk_author_affiliation" style="margin-bottom: 0.3em;">
              joint work with</div>
            <div class="talk_author_name" style="margin-bottom: 0.3em;">
              Daniel Dadush, Sophie Huiberts (CWI Amsterdam)
              <br> and <br> L&aacute;szl&oacute; V&eacute;gh (LSE)<span class="superscript">&nbsp;</span> </div>
          <img src="./data/cwi-logo.png" style="height: 120px; margin: 0px 5px
0px 20px;"/>

           <img src="./data/dan.jpg" style="height: 150px; margin: 0px 20px 0px 20px;"/>

           <!-- <img src="./data/dan.jpg" style="float:right; visibility:
hidden; height: 150px; margin: 0px 20px 0px 20px;"/> -->
            <img src="./data/Sophie.jpg" style="height: 150px; margin: 0px 20px 0px 20px;"/>
           <img src="./data/vegh.jpg" style="height: 150px; margin: 0px 20px 0px 20px;"/>
          <img src="./data/lse-logo.png" style="height: 120px; margin: 0px 20px 0px 20px;"/>
          </div>
        <div class="talk_occasion">STOC 2020</div>
        <div class="text_centered" style="margin-top: 1em;">
          <!-- <img src="../../presentations_shared/images/logo_huygens_ing_0.30.gif" style="height: 85px; margin: 0px 20px 0px 20px;"/> -->

        </div>
      </div>

<!-- <div id="step-title" class="step"
  data-x="5000" data-y="5000" data-z="0">
  <div  style="position: relative;
  top: 50%;
  transform: translateY(-60%);">
  <h1 class="title">A scaling invariant algorithm for Linear Programming</h1>

  <p>Bento Natura</p>
  <p>
    Department of Mathematics<br>
    London School of Economics
  </p>
  </div>
</div> -->

<div id="step-LP-formulation" class="step" data-rel-x="3000" data-rel-y="0" data-rel-z="0" data-scale="1" >
  <h2 class="center-text">Linear Programming</h2>
    <p>
    In standard form for $$A \in \mathbb{Q}^{m \times n}$$, $$b\in \mathbb{Q}^m$$, $$c\in \mathbb{Q}^n$$,
    
    <div class="box" style="width: 70%; height: 25%;">
<font class="fr">
    $$$
      \begin{aligned}
      \min \; &c^\top x & \max \; & y^\top b \\
      Ax& =b & \qquad A^\top y + s &= c \\
      x &\geq 0 & s & \geq 0 \\
      \end{aligned}
      $$$
    </font>
    </div>
    <img src="./data/lp-pic.png" style="position: relative;" height="200px"/>
  </p>
  <div class="box" style="width: 70%; height: 30%;">
   LP with <font class="fr"> $$n$$</font> variables, <font class="fr">$$m$$ </font>constraints
<br>
 <font class="fr">$$L$$</font>: encoding length of the input <font class="fr">$$(A,b,c)$$</font>. 
 <br>
 Weakly polynomial algorithms: Ellipsoid Method and Interior Point Methods run in <font class="fr">$$\mathrm{poly}(n,m,L)$$</font>
 <br>
 <font class="gold"> Strongly polynomial algorithm:</font> Is there an algorithm that runs in <font class="fr">  $$\mathrm{poly}(n,m)$$</font> arithmetic operations? (Smale's 9th question) 
 </div>
 <img src="./data/holygrail.png" style="height: 150px;"/>


  <!-- <canvas class="center-block" width="800px" height="400px"></canvas> -->
</div>

<!-- <div id="step-LP-motivation" class="step">
  <h2> Motivation - Background</h2>
  pretty obvious. Might leave empty.
</div> -->


<!-- <div id="step-weakly-vs-strongly-polynomial" class="step">
    <h2 class="center-text">Weakly vs Strongly Polynomial Algorithms for LP</h2>
LP with <font class="fr"> $$n$$</font> variables, <font class="fr">$$m$$ </font>constraints
<br>
 <font class="fr">$$L$$</font>: encoding length of the input <font class="fr">$$(A,b,c)$$</font>. 
 <br>
 Ellipsoid Method and Interior Point Methods <font class="fr">$$\mathrm{poly}(n,m,L)$$</font>
 <br>
 Strongly poly algorithm: <font class="fr">$$\mathrm{poly}(n,m)$$</font> arithmetic operations (Smale's question) 
 <img src="./data/holygrail.png" style="height: 150px; float: right"/>
</div> -->

<div id="step-strongly-polynomial-general-1" class="step">
      <h2 class="center-text">Dependence on the constraint matrix only</h2>
      <p class="center-text">
       <font class="fr"> $$\min c^\top x,\, Ax=b,\, x\ge 0$$</font><br>
       Running time dependent only on constraint matrix $$A$$, <span class="em2"> but not on</span> $$b$$ and $$c$$.
      </p>

      <div class="box" style="width: 50%; height: 65%">

      <fieldset style="height:100%; border: 1px black solid;">
          <legend style="border: 1px black solid;margin-left: 1em; padding: 0.2em 0.8em ">General LP</legend>
          <ul class="lst">
            <li>
              <font class="ref">'Combinatorial LPs'</font>
              <br>
              If $$A$$ integral and $$|\mathrm{det}(B)| \leq \Delta$$ for all square submatrices of $$A$$, then LP solvable in <font class="fr">$$\mathrm{poly}(m,n,\log(\Delta))$$</font> arithmetic operations: <font class="ref">Tardos '86</font> <br> 
              <ul class="lst">
                <li>Note $$\Delta = 1$$ for TU-matrices.</li>
                <li>If matrix entries bounded in <font class="fr">$$\mathrm{poly}(n)$$</font> then the algorithm is strongly polynomial.</li>
              </ul> 
            </li>
           
          </ul>
          </fieldset>
          </div>

          <div class="box" style="margin-top: 6px; width: 50%; height: 65.5%">

          <fieldset style="height:100%; border: 1px black solid; position: relative; top: -10px">
            <legend style="border: 1px black solid;margin-left: 1em; padding: 0.2em 0.8em ">Condition number <font class="fr"> $$\bar\chi_A$$</font></legend>
        <b>Lifting cost definition:</b> $$\bar\chi_A$$ is the
minimum number $$M \geq 1$$
such that for all $$I \subseteq [n]$$ and $$x \in \pi_I(\ker(A))$$,
there exists $$\hat{x} \in \ker(A)$$ satisfying $$\hat{x}_I = x$$ and
$$\|\hat{x}\| \leq M \|x\|$$. 

<!-- <b> Example: </b> If $$(2,1,*,*) \in \ker(A)$$, $$\exists (2,1,v_3,v_4) \in \ker(A)$$
with $$\|(2,1,v_3,v_4)\| \leq M\|(2, 1)\|$$.</br> -->

        <ul class="lst" style="margin-top: 0px;">
        <li>
          Depends only on the subspace $$\ker(A)$$.
        </li>
        <li> $$\bar\chi_A = O(2^{L_A})$$. </li>
        <li> $$\bar\chi_A \le \sqrt{n}m \Delta$$ for integer matrices $$A$$ : <font
          class="ref">Tun&ccedil;el '93</font>.  </li>
        <!-- <li>
        Governs the stability of <font class="fr">LLS</font> steps.
        </li> -->
         <li>
           NP-hard to approximate within a factor <font
class="fr">$$2^{\mathrm{poly}(n)}$$</font>: <font
class="ref">Tun&ccedil;el '99</font>.
              </li>
              <!--
              <li>Let $$\barfto\chi_A^* := \inf\{\bar\chi_{AD}: D \text{ diagonal, positive definite}\}$$</li> be the optimal rescaling.
            -->
            </ul>
            </fieldset>
            </div>
</div>

d

<div id="step-is-there-scale-invariance-1" class="step">
  <h2 class="center-text">Scale Invariance</h2>
      <h5>
     <font class="fr">
  $$$
    \begin{aligned}
    \min \; &c^\top x & \max \; & y^\top b \quad \text{(LP)} \\
    Ax& =b & \qquad A^\top y + s &= c \\
    x &\geq 0 & s &\geq 0 \\
    \end{aligned}
    $$$
     </font>
   </h5>
  <font class="fr">$$A\in \R^{m\times n}$$.</font> Let <font class="fr">$$\mathbf{D}$$</font> denote the set of $$n\times n$$ positive diagonal matrices.
  <ul class="lst">
     <li> <span class="em2">Diagonal rescaling (LP') of (LP):</span>
Replace $$A'=AD$$, $$c'=Dc$$, $$b'=b$$ for some $$D\in \mathbf{D}$$.
    </li>
    <li>
      <span class="em2">Central path is invariant under rescaling</span>:
central path of (LP) mapped to that of (LP') by $$(x(\mu),s(\mu),y(\mu))
\rightarrow (D^{-1}x(\mu), Ds(\mu),y(\mu))$$.
    <li>
      Standard interior point methods are <span class="em2">invariant</span> under rescaling.
    </li>
   <li>
      The Vavasis&ndash;Ye (<font class="fr">VY</font>) (96') algorithm solves LP in <font class="fr">$$O(n^{3.5}\log(\bar\chi_A +n))$$</font> linear system solves is <span class="em2">not scaling invariant</span>. 
      <li>
        The condition number <font class="fr">$$\bar\chi$$ </font> is not scaling-invariant.
      </li>
    </li>
<!-- </span>: </br>
<font class="fr">LLS</font> steps solve linear system indexed by the current variable ordering </br>
$$x_{\pi[1]} > \cdots > x_{\pi[n]}$$ and the ratios $$x_{\pi[i]}/x_{\pi[i+1]}$$,
$$i \in [n-1]$$.
    </li>
    <li>
      <font class="fr"> VY </font> Algorithm uses $$O(n^{3.5} \log\bar\chi_A)$$ LLS steps [VY96].
    </li> --> 
  </ul>
</div>

<div id="step-our-contributions" class="step">
  <h2 class="center-text"> Our contributions:
Dadush&ndash;Huiberts&ndash;N.&ndash;V&eacute;gh '20</h2>

<font class="fr">
  $$$\bar\chi_A^* := \inf\{\bar\chi_{AD}: D\in \mathbf{D}\}.$$$</font>

  <fieldset style="border: 1px black solid">

    <legend style="border: 1px black solid;margin-left: 1em; padding: 0.2em 0.8em"> A scaling invariant algorithm</legend>
      We give a scaling invariant LLS interior point method, settling the open question posed by <font class="ref">Monteiro and Tsuchiya in '03</font>.
      </fieldset>
      <fieldset style="border: 1px black solid; position: relative; top: 7px">
          <legend style="border: 1px black solid;margin-left: 1em; padding: 0.2em 0.8em ">Improved Runtime</legend>
         We show a running time bound of <font class="fr">$$O(n^{2.5}\log(\bar\chi_A^\ast +n)\log n)$$</font> linear system solves. This is achieved via an improved analysis that also applies to the original <font class="ref">Vavasis-Ye</font> algorithm that requires <font class="fr">$$O(n^{3.5}\log(\bar\chi_A +n))$$</font> linear system solves.
        </fieldset>
      <fieldset style="border: 1px black solid; position: relative; top: 14px">
      <legend style="border: 1px black solid;margin-left: 1em; padding: 0.2em 0.8em ">Finding a nearly-optimal rescaling of $$A$$</legend>
Given <font class="fr">$$A \in \R^{m \times n}$$</font>, in <font
class="fr">$$O(n^2m^2 + n^3)$$</font> time, we can compute: <br>
      <!-- <ol class="lst" style="position:relative; top:-20px; margin-bottom: -20px;"> -->
   <!--        <li>
 <font class="ref">Tun&ccedil;el '99</font>: There exists no
$$2^{\mathrm{poly}(\mathrm{rank}(A))}$$-approximation of <font class="ref">$$\bar\chi_A$$</font>.
      </li> -->
      (i) rescaling <font class="fr">$$D \in \mathbf{D}$$</font> satisfying
       <font class="fr">
$$ \bar\chi_A^*\le \bar\chi_{AD}\le n (\bar\chi_A^*)^3$$</font>, (ii) <font class="fr">$$t \geq 1$$</font> satisfying
<font class="fr">$$t \leq \bar \chi_A \leq n(\bar{\chi}_A^*)^2t$$</font>.
        <!-- </li> -->
     <!-- </ol> -->
      </fieldset>
</div>


<div id="step-our-techniques" class="step">
  <h2 class="center-text"> Techniques</h2>
  <div style="width: 0%; margin: auto"></div>
  
  <div class="box" style="width: 50%; height: 45%">
      <fieldset style="border: 1px black solid; position: relative; top: 7px; width: 70%">
          <legend style="border: 1px black solid;margin-left: 1em; padding: 0.2em 0.8em ">Layered Least Squares - Interior Point Method</legend>
        Path-following with alternating Predictor and Corrector steps. Partition the variables into <span class="em2">scaling-invariant</span> layers. Find Newton-update layer by layer.
        </fieldset>
   </div>
   <div class="box" style="width: 45%; height: 30%">
    <canvas id="chart_canvas3"></canvas>
          </div>
      <div class="box" style="width: 100%">
  <fieldset style="border: 1px black solid; width: 90%">
    <legend style="border: 1px black solid;margin-left: 1em; padding: 0.2em 0.8em">Progress Measure - Circuit imbalance</legend>
    A <span class="em2">circuit</span> of $$A$$ is a minimal linearly dependent subset of columns $$C \subseteq [n]$$. <br>
    Imbalance measure <font class="fr"> $$\kappa_{ij} := \max\left\{\left|\frac{g_j}{g_i} \right|: \{i,j\} \subset \mathrm{supp}(g),\, Ag=0,\, \mathrm{supp}(g) \in \mathcal{C}\right\}$$</font> with optimal rescaling <font class="fr">$$\kappa_{ij}^*$$</font>.
    For some variables <font class="fr"> $$i, j$$</font> initially <font class="fr">$$x_j \gg \kappa_{ij}^*x_i$$</font> and after  <font class="fr"> $$O(n\log \bar\chi^*)$$ </font> iterations <font class="fr">$$x_j \ll \kappa_{ij}^*x_i$$</font> <span class="em2">forever thereafter</span>. $$\rightsquigarrow$$ can only happen $$n^2$$ times.
      </fieldset>
     </div>
</div>


<!-- <div id="step-limitation" class="step">
    <h2 class="center-text">Limitation</h2>
    <div class="theorem"> <font class="ref"> [Allamigeon&ndash;Benchimol&ndash;Gaubert&ndash;Joswig '18]</font>
      <br>
      No standard path following method can be strongly polynomial.
    </div>
    <p> Proof using <span class="em2">tropical geometry</span>: studies the tropical limit of a family of parametrized linear programs.

  <p> <b> Standard LP Central Path (CP):</b>

  <div class="box" style="float: right">
      <img src="data/central_path.png" style="height: 55%;">
  </div>

    <font class="fr">
    $$$
    \begin{aligned}
    Ax(\mu)& =b   \\
    A^\top y(\mu) + s(\mu) &= c  \\
    x_i(\mu) s_i(\mu) &= \mu, i \in [n] \\
    x(\mu) &> 0, s(\mu) > 0.
    \end{aligned}
    $$$
      </font>
<font class="fr">
$$$
\begin{aligned}
\text{CP} &:= \{w(\mu): \mu > 0\}, \\
w(\mu) &:= (x(\mu),s(\mu),y(\mu)).
\end{aligned}
$$$
</font>
</p>
  </div> -->

<!-- <div id="step-overview-3" class="step" data-x="13000" data-y="11000" data-scale="12">
</div> -->

<!-- <div id="IPM-main" class="step"   data-scale="6" data-rel-x="1.0w" data-rel-y="-4.5h" data-rel-to="step-limitation">
    <h2 class="center-text">A crash course in Interior Point Methods</h2>
</div> -->



  <div id="step-primal-dual-animation" class="step" >
      <h3 class="center-text"><i></i></h1>
      <!-- <h4 class="center-text i"> <i> Press key "i" to run iteration </i></h4> -->
      <br>
      <div style="width: 0%; margin: auto">
        <canvas style="text-align: center" id="chart_canvas2"></canvas>
        <!-- <progress id="animationProgress2" max="1" value="0" style="width: 100%"></progress> -->
      </div>
      <br>
      <br>
  </div>




<script>
    document.addEventListener('keypress', function(e){
      console.log(e.which);
              if(e.which === 115 ){ //s
                window.location.href = "stoc.html#/step-primal-dual-animation";
              } else if(e.which === 111){ //o
                window.location.href = "stoc.html#/step-overview-3";
              }})
  </script>

<script src="chart1.js"></script>
<script src="chart2.js"></script>


<div class="impress-progressbar"><div></div></div>
<div class="impress-progress"></div>

<!-- <div id="impress-help"></div> -->

<!-- <script src="lib/js/impress.js"></script> -->
<script type="text/javascript" src="impress.js/js/impress.js"></script>
<script>impress().init();</script>
</body>
</html>
